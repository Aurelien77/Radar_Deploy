<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{ current_page_name }}</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    a:active,
    a:hover {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      overflow: auto;
      min-height: 100vh;
    }
    #container {
      display: flex;
      height: 100vh;
      transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }
    #radar-container {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }
    #radar-container.shifted {
      flex: 0 0 25%;
      min-width: 300px;
    }
    canvas {
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      cursor: pointer;
      width: 1000px;
      height: 900px;
      max-width: none;
    }
    .nav-link {
      padding: 8px 15px;
      border: 1px solid rgba(255, 255, 255, 0.3);
      color: white;
      text-decoration: none;
      border-radius: 8px;
      text-align: center;
      display: block;
      margin-bottom: 8px;
      transition: all 0.3s ease;
      font-size: 14px;
    }
    .nav-link.veille { background: #764ba2; }
    .nav-link.application { background: #667eea; }
    .nav-link:hover {
      transform: translateX(5px);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }
    .nav-link.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      font-weight: bold;
      border: 2px solid white;
    }
    .led {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      box-shadow: 0 0 8px currentColor;
      animation: pulse 2s ease-in-out infinite;
    }
    .led-red { background: #ff4444; color: #ff4444; }
    .led-green { background: #44ff44; color: #44ff44; }
    @keyframes pulse {
      0%,100% { opacity: 1; box-shadow: 0 0 8px currentColor; }
      50% { opacity: 0.6; box-shadow: 0 0 15px currentColor; }
    }
    #top-banner {
      margin-bottom: 15px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 12px 30px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: bold;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      text-align: center;
      display: flex;
      align-items: center;
      gap: 15px;
    }
    #side-panel {
      width: 0;
      background: white;
      overflow-y: auto;
      overflow-x: hidden;
      transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      box-shadow: -5px 0 20px rgba(0, 0, 0, 0.2);
      display: flex;
      flex-direction: column;
    }
    #side-panel.open { width: 75%; }
    #panel-header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      position: sticky;
      top: 0;
      z-index: 10;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    #panel-header h2 { font-size: 28px; margin-bottom: 10px; }
    #panel-header .meta { opacity: 0.9; font-size: 14px; }
    #close-btn {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(255, 255, 255, 0.2);
      border: 2px solid white;
      color: white;
      padding: 10px 20px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      transition: all 0.3s ease;
    }
    #close-btn:hover { background: white; color: #667eea; transform: scale(1.05); }
    #panel-content { padding: 30px; flex: 1; }
    .files-nav {
      display: flex;
      gap: 10px;
      margin-bottom: 30px;
      flex-wrap: wrap;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 10px;
      border-left: 4px solid #667eea;
    }
    .files-nav-title {
      width: 100%;
      font-weight: bold;
      color: #667eea;
      margin-bottom: 10px;
      font-size: 16px;
    }
    .file-tab {
      padding: 10px 20px;
      background: white;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 500;
      color: #333;
    }
    .file-tab:hover {
      border-color: #667eea;
      background: #f0f4ff;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(102,126,234,0.2);
    }
    .file-tab.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-color: transparent;
      box-shadow: 0 4px 12px rgba(102,126,234,0.4);
    }
    .file-display { display: none; }
    .file-display.active { display: block; animation: fadeIn 0.3s ease; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .file-section {
      margin-bottom: 30px;
      background: #f8f9fa;
      border-radius: 10px;
      padding: 20px;
      border-left: 4px solid #667eea;
    }
    .file-section h3 {
      color: #667eea;
      margin-bottom: 15px;
      font-size: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .file-content {
      background: white;
      padding: 20px;
      border-radius: 8px;
      font-family: "Courier New", monospace;
      font-size: 14px;
      line-height: 1.6;
      white-space: pre-wrap;
      word-wrap: break-word;
      max-height: 600px;
      overflow-y: auto;
      border: 1px solid #e0e0e0;
    }
    .no-files {
      text-align: center;
      padding: 80px 40px;
      color: #667eea;
      background: linear-gradient(135deg, #f0f4ff 0%, #e8ecff 100%);
      border-radius: 15px;
      border: 2px dashed #667eea;
    }
    .no-files-icon { font-size: 64px; margin-bottom: 20px; opacity: 0.7; }
    .no-files-title { font-size: 24px; font-weight: bold; margin-bottom: 15px; color: #667eea; }
    .no-files-text { font-size: 16px; color: #666; font-style: italic; }
    #tooltip {
      position: fixed;
      background: rgba(0,0,0,0.9);
      color: white;
      padding: 10px 15px;
      border-radius: 8px;
      font-size: 14px;
      pointer-events: none;
      display: none;
      z-index: 1000;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }
    .ring-label {
      font-weight: bold;
      padding: 2px 8px;
      border-radius: 4px;
      display: inline-block;
      margin-right: 5px;
    }
    .file-content::-webkit-scrollbar { width: 8px; }
    .file-content::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 4px; }
    .file-content::-webkit-scrollbar-thumb { background: #888; border-radius: 4px; }
    .file-content::-webkit-scrollbar-thumb:hover { background: #555; }
  </style>
</head>
<body>
  <div id="container">
    <header style="background: #667eea; color: white; padding: 15px 30px; display: flex; flex-direction: column; gap: 10px">
      <div id="top-banner">
        <span class="led led-red"></span>
        <span>{{ current_page_name }}</span>
        <span class="led led-green"></span>
      </div>
      {% for radar in all_radars %} {% if radar.name != current_page %}
      <a href="{{ radar.url }}" class="nav-link {{ radar.type }}"> {{ radar.display_name }} </a>
      {% endif %} {% endfor %}
    </header>

    <div id="radar-container">
      <canvas id="radar" width="1000" height="900"></canvas>
    </div>

    <div id="side-panel">
      <div id="panel-header">
        <button id="close-btn">âœ• Fermer</button>
        <h2 id="tech-name"></h2>
        <div class="meta">
          <span id="tech-section"></span> â€¢
          <span id="tech-ring"></span>
        </div>
      </div>
      <div id="panel-content"></div>
    </div>
  </div>

  <div id="tooltip"></div>

  <script>
    const RADAR_TYPE = "{{ radar_type }}";
    const technologies = {{ technologies | tojson }};

const sections = {{ sections | tojson }};
const ringColors = {{ colors | tojson }};
    const ringNames = Object.keys(ringColors);

    const rings = calculateRings();

    function calculateRings() {
        if (RADAR_TYPE === "application") return [13.33,26.66,40];
        else return [20,30,40];
    }

    const canvas = document.getElementById('radar');
    const ctx = canvas.getContext('2d');
    const centerX = canvas.width / 2;
    const centerY = canvas.height / 2;
    const scale = 8.5;
    const numSections = Object.keys(sections).length;
    const sectionAngle = 360 / numSections;

    let hoveredTech = null;
    let selectedTech = null;
    let hoveredSection = null;
    let hoveredRing = null;
    let lockedSection = null;
    let lockedRing = null;
    const tooltip = document.getElementById('tooltip');
    const sidePanel = document.getElementById('side-panel');
    const radarContainer = document.getElementById('radar-container');
    const closeBtn = document.getElementById('close-btn');

    technologies.forEach(t => {
        t._anim = { progress: 0, delay: Math.random()*400, duration: 700+Math.random()*500 };
    });

    let lastFrame = performance.now();

    function drawRadar() {
      ctx.clearRect(0,0,canvas.width,canvas.height);

      // Highlight section
      if (hoveredSection!==null||lockedSection!==null) {
        const activeSection = lockedSection!==null?lockedSection:hoveredSection;
        const start = (activeSection-1)*sectionAngle-90;
        const end = start+sectionAngle;
        ctx.beginPath();
        ctx.moveTo(centerX,centerY);
        ctx.arc(centerX,centerY,40*scale,start*Math.PI/180,end*Math.PI/180);
        ctx.closePath();
        ctx.fillStyle='rgba(102,126,234,0.15)';
        ctx.fill();
      }

      // Highlight ring
      if (hoveredRing!==null||lockedRing!==null) {
        const activeRing = lockedRing!==null?lockedRing:hoveredRing;
        const i = ringNames.indexOf(activeRing);
        const inner = i===0?0:rings[i-1]*scale;
        const outer = rings[i]*scale;
        ctx.beginPath();
        ctx.arc(centerX,centerY,outer,0,2*Math.PI);
        if(inner>0) ctx.arc(centerX,centerY,inner,0,2*Math.PI,true);
        ctx.fillStyle=ringColors[activeRing]+'33';
        ctx.fill();
      }

      // Rings
      rings.forEach((radius,i)=>{
        ctx.beginPath();
        ctx.arc(centerX,centerY,radius*scale,0,2*Math.PI);
        ctx.strokeStyle='#333';
        ctx.lineWidth=2;
        ctx.stroke();

        const labelRadius=(i===0?radius/2:(radius+rings[i-1])/2)*scale;
        const x=centerX+labelRadius*0.7;
        const y=centerY-labelRadius*0.7;
        ctx.font='bold 11px Arial';
        const name=ringNames[i]||'';
        const metrics=ctx.measureText(name);
        ctx.fillStyle='rgba(0,0,0,0.5)';
        ctx.fillRect(x-metrics.width/2-6,y-12,metrics.width+12,20);
        ctx.fillStyle='#fff';
        ctx.textAlign='center';
        ctx.textBaseline='middle';
        ctx.fillText(name,x,y-2);
      });

      // Section lines & labels
      const innerRadius = RADAR_TYPE==="application"?rings[0]:0;
      for(let s=1;s<=numSections;s++){
        const angle=(s-1)*sectionAngle-90;
        const rad=angle*Math.PI/180;
        const x1=centerX+innerRadius*scale*Math.cos(rad);
        const y1=centerY+innerRadius*scale*Math.sin(rad);
        const x2=centerX+40*scale*Math.cos(rad);
        const y2=centerY+40*scale*Math.sin(rad);
        ctx.beginPath();
        ctx.moveTo(x1,y1);
        ctx.lineTo(x2,y2);
        ctx.strokeStyle='#4169E1';
        ctx.lineWidth=2;
        ctx.stroke();
      }
      Object.entries(sections).forEach(([s,name])=>{
        const angle=(parseInt(s)-1)*sectionAngle-90+sectionAngle/2;
        const rad=angle*Math.PI/180;
        const x=centerX+52*scale*Math.cos(rad);
        const y=centerY+52*scale*Math.sin(rad);
        ctx.font='bold 12px Arial';
        ctx.textAlign='center';
        ctx.textBaseline='middle';
        const metrics=ctx.measureText(name);
        const active=(hoveredSection===parseInt(s)||lockedSection===parseInt(s));
        ctx.fillStyle=active?'#667eea':'#f0f0f0';
        ctx.fillRect(x-metrics.width/2-8,y-12,metrics.width+16,24);
        ctx.strokeStyle=active?'#667eea':'#333';
        ctx.lineWidth=active?2:1.5;
        ctx.strokeRect(x-metrics.width/2-8,y-12,metrics.width+16,24);
        ctx.fillStyle=active?'white':'#333';
        ctx.fillText(name,x,y);
      });

      // Technology points
      technologies.forEach(t=>{
        const anim=t._anim;
        let prog=anim._computedProgress!==undefined?anim._computedProgress:anim.progress||0;
        const x=centerX+t.x*scale*prog;
        const y=centerY+t.y*scale*prog;
        const hover=hoveredTech===t;
        const sel=selectedTech===t;
        
        const r=hover?5:(sel?6:5);
        ctx.beginPath();
        ctx.arc(x,y,r,0,2*Math.PI);
        ctx.fillStyle=ringColors[t.ring]||'#999';
        ctx.fill();
        ctx.strokeStyle=hover?'#000':'#333';
        ctx.lineWidth=hover?3:2;
        ctx.stroke();
        ctx.font=hover?'bold 9px Arial':'8px Arial';
        ctx.textAlign='center';
        ctx.textBaseline='top';
        const metrics=ctx.measureText(t.name);
        ctx.fillStyle='rgba(255,255,255,0.9)';
        ctx.fillRect(x-metrics.width/2-3,y+r+2,metrics.width+6,14);
        ctx.fillStyle=hover?'#667eea':'#333';
        ctx.fillText(t.name,x,y+r+4);
      });
    }

    function animationLoop(now){
      const dt=now-lastFrame; lastFrame=now;
      let any=false;
      technologies.forEach(t=>{
        const a=t._anim;
        if(a.progress>=1){a._computedProgress=1;return;}
        if(a.delay>0){a.delay-=dt;a._computedProgress=0;any=true;return;}
        a.progress+=dt/a.duration;
        if(a.progress>1)a.progress=1;
        a._computedProgress=1-Math.pow(1-a.progress,3);
        if(a._computedProgress<1) any=true;
      });
      drawRadar();
      if(any) requestAnimationFrame(animationLoop);
    }

    function getSectionFromMouse(mx,my){
      const dx=mx-centerX,dy=my-centerY;
      const dist=Math.sqrt(dx*dx+dy*dy);
      if(dist>40*scale) return null;
      let angle=(Math.atan2(dy,dx)*180/Math.PI+90+360)%360;
      const s=Math.floor(angle/sectionAngle)+1;
      return s>numSections?1:s;
    }

    function getRingFromMouse(mx,my){
      const dx=mx-centerX,dy=my-centerY;
      const dist=Math.sqrt(dx*dx+dy*dy);
      for(let i=0;i<rings.length;i++){
        const inner=i===0?0:rings[i-1];
        const outer=rings[i];
        if(dist/scale>=inner&&dist/scale<=outer) return ringNames[i];
      }
      return null;
    }

    canvas.addEventListener('mousemove',e=>{
      const rect=canvas.getBoundingClientRect();
      const mx=e.clientX-rect.left,my=e.clientY-rect.top;
      hoveredTech=null;
      technologies.forEach(t=>{
        const prog=t._anim._computedProgress!==undefined?t._anim._computedProgress:t._anim.progress||0;
        const x=centerX+t.x*scale*prog;
        const y=centerY+t.y*scale*prog;
        const dist=Math.sqrt(Math.pow(mx-x,2)+Math.pow(my-y,2));
        if(dist<15){
          hoveredTech=t;
          tooltip.style.display='block';
          tooltip.style.left=e.clientX+15+'px';
          tooltip.style.top=e.clientY+15+'px';
          tooltip.innerHTML=`<strong>${t.name}</strong><br>${sections[t.section]}<br>${t.ring}`;
        }
      });
      if(!hoveredTech) tooltip.style.display='none';
      if(!hoveredTech&&!lockedSection&&!lockedRing){
        hoveredSection=getSectionFromMouse(mx,my);
        hoveredRing=getRingFromMouse(mx,my);
      }
      canvas.style.cursor=hoveredTech?'pointer':'default';
      drawRadar();
    });

    canvas.addEventListener('mouseleave',()=>{
      hoveredTech=null; hoveredSection=null; hoveredRing=null;
      tooltip.style.display='none'; drawRadar();
    });

    canvas.addEventListener('click',e=>{
      const rect=canvas.getBoundingClientRect();
      const mx=e.clientX-rect.left,my=e.clientY-rect.top;
      if(hoveredTech){ selectedTech=hoveredTech; openPanel(selectedTech); }
      else{
        const sec=getSectionFromMouse(mx,my);
        if(sec!==null){ lockedSection=lockedSection===sec?null:sec; if(lockedSection) lockedRing=null; }
        const ring=getRingFromMouse(mx,my);
        if(ring!==null && lockedSection===null){ lockedRing=lockedRing===ring?null:ring; }
        drawRadar();
      }
    });

    function showFile(index){
      currentFileIndex=index;
      document.querySelectorAll('.file-display').forEach((d,i)=>d.classList.toggle('active',i===index));
      document.querySelectorAll('.file-tab').forEach((t,i)=>t.classList.toggle('active',i===index));
    }

    async function loadComments(techName) {
  const res = await fetch(`/get_comments/${encodeURIComponent(techName)}`);
  const comments = await res.json();
  const list = document.getElementById('comments-list');
  list.innerHTML = '';

  if (comments.length === 0) {
    list.innerHTML = '<p style="color:#666;font-style:italic;">Aucun commentaire pour le moment.</p>';
  } else {
    comments.forEach(c => {
      const div = document.createElement('div');
      div.style.cssText = 'padding:10px;margin-bottom:8px;background:#f0f4ff;border-radius:8px;border-left:4px solid #667eea;';
      div.innerHTML = `
        <strong>${c.nom} ${c.prenom}</strong>
        <span style="color:#999;font-size:12px;">(${c.poste})</span>
        <span style="float:right;cursor:pointer;color:#ff5555;font-weight:bold;" onclick="deleteComment('${techName}','${c.timestamp}')">âœ•</span>
        <br><span style="color:#333;">${c.commentaire}</span>
        <br><span style="color:#aaa;font-size:11px;">${new Date(c.timestamp).toLocaleString('fr-FR')}</span>
      `;
      list.appendChild(div);
    });
  }
}

async function addComment(techName) {
  const nom = document.getElementById('comment-lastname').value.trim();
  const prenom = document.getElementById('comment-firstname').value.trim();
  const poste = document.getElementById('comment-role').value.trim();
  const commentaire = document.getElementById('comment-input').value.trim();

  if (!nom || !prenom || !poste || !commentaire) {
    return alert("Veuillez remplir tous les champs.");
  }

  await fetch('/add_comment', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ technology: techName, nom, prenom, poste, commentaire })
  });

  // RÃ©initialiser les champs
  document.getElementById('comment-firstname').value = '';
  document.getElementById('comment-lastname').value = '';
  document.getElementById('comment-role').value = '';
  document.getElementById('comment-input').value = '';

  loadComments(techName);
}

async function deleteComment(techName, timestamp) {
  await fetch('/delete_comment', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ technology: techName, timestamp: timestamp })
  });

  loadComments(techName);
}

async function clearComments(techName) {
  if (!confirm("Voulez-vous vraiment supprimer tous les commentaires ?")) return;

  // RÃ©cupÃ¨re tous les commentaires puis les supprime un par un
  const res = await fetch(`/get_comments/${encodeURIComponent(techName)}`);
  const comments = await res.json();

  for (const c of comments) {
    await fetch('/delete_comment', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ technology: techName, timestamp: c.timestamp })
    });
  }

  loadComments(techName);
}

function renderList(title, items){
  if(!items || items.length === 0){
    return `
      <div class="file-section">
        <h3>${title}</h3>
        <div class="file-content">Aucune information pour le moment.</div>
      </div>
    `;
  }

  let html = `<div class="file-section"><h3>${title}</h3><ul>`;
  items.forEach(i=>{
    html += `<li>${i}</li>`;
  });
  html += `</ul></div>`;
  return html;
}

function openPanel(tech) {
console.log(technologies.find(t => t.name === "Selenium"));
  console.log(JSON.stringify(technologies.find(t => t.name === "Selenium"), null, 2));
    // Mise Ã  jour du header du panneau
    document.getElementById('tech-name').textContent = tech.name;
    document.getElementById('tech-section').textContent = sections[tech.section];

    const ringSpan = document.getElementById('tech-ring');
    ringSpan.textContent = tech.ring;
    ringSpan.className = 'ring-label';
    ringSpan.style.backgroundColor = ringColors[tech.ring] || '#999';
    ringSpan.style.color = 'white';

    // RÃ©initialisation
    const content = document.getElementById('panel-content');
    let html = '';

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // 1. Description
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    if (tech.description) {
        html += `
        <div class="file-section">
            <h3>ğŸ“ Description</h3>
            <div class="file-content">${tech.description}</div>
        </div>`;
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // 2. Avantages / InconvÃ©nients / Comparatifs
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function addListSection(title, icon, items) {
        const empty = !items || !Array.isArray(items) || items.length === 0;
        html += `
        <div class="file-section">
            <h3>${icon} ${title}</h3>
            <div class="file-content">
                ${empty 
                    ? "Aucune information pour le moment." 
                    : `<ul style="margin: 0; padding-left: 20px;">${items.map(item => `<li>${item}</li>`).join('')}</ul>`
                }
            </div>
        </div>`;
    }

    addListSection("Avantages",    "âœ…", tech.avantages);
    addListSection("InconvÃ©nients", "âš ï¸", tech.inconvenients);
    addListSection("Comparatifs",  "ğŸ”", tech.comparatifs);

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // 3. Bloc des fichiers (comme avant)
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    if (tech.files && tech.files.length > 0) {
        // Onglets si plusieurs fichiers
        if (tech.files.length > 1) {
            html += `
            <div class="files-nav">
                <div class="files-nav-title">ğŸ“‘ Fichiers disponibles (${tech.files.length})</div>`;
            tech.files.forEach((f, i) => {
                html += `<div class="file-tab ${i === 0 ? 'active' : ''}" onclick="showFile(${i})">ğŸ“„ ${f.name}</div>`;
            });
            html += '</div>';
        }

        // Contenu de chaque fichier
        tech.files.forEach((f, i) => {
            html += `
            <div class="file-display ${i === 0 ? 'active' : ''}">
                <div class="file-section">
                    <h3>ğŸ“„ ${f.name}</h3>
                    <div class="file-content">${f.content || '(contenu vide)'}</div>
                </div>
            </div>`;
        });
    } else {
        html += `
        <div class="no-files">
            <div class="no-files-icon">ğŸ”¬</div>
            <div class="no-files-title">Ã‰tude en cours</div>
            <div class="no-files-text">L'Ã©tude de cette technologie est en cours</div>
        </div>`;
    }

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // 4. Commentaires 
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    html += `
    <!-- Partie commentaires dans le panel -->
    <div id="comments-section">
      <h3>ğŸ’¬ Commentaires</h3>
      <div id="comments-list"></div>
      <input type="text" id="comment-firstname" placeholder="PrÃ©nom" style="width:32%; margin-right:2%;"/>
      <input type="text" id="comment-lastname" placeholder="Nom" style="width:32%; margin-right:2%;"/>
      <input type="text" id="comment-role" placeholder="Poste" style="width:32%;"/>
      <textarea id="comment-input" placeholder="Ajouter un commentaire..." rows="3" style="width:100%; margin-top:10px;"></textarea>
      <button id="add-comment-btn">Ajouter</button>
      <button id="clear-comments-btn" style="margin-left:10px;background:#ff5555;color:white;">
        Supprimer
      </button>
    </div>`;
console.log(selectedTech.name);
console.log("Avantages    :", selectedTech.avantages);
console.log("InconvÃ©nients:", selectedTech.inconvenients);
console.log("Comparatifs  :", selectedTech.comparatifs);
console.log("Fichiers     :", selectedTech.files);
    // Injection du HTML
    content.innerHTML = html;

    // Activation des interactions
    loadComments(tech.name);
    document.getElementById('add-comment-btn').onclick = () => addComment(tech.name);
    document.getElementById('clear-comments-btn').onclick = () => clearComments(tech.name);

    // Ouverture du panneau
    sidePanel.classList.add('open');
    radarContainer.classList.add('shifted');
}
    closeBtn.addEventListener('click',()=>{
      sidePanel.classList.remove('open');
      radarContainer.classList.remove('shifted');
      selectedTech=null;
      drawRadar();
    });

    requestAnimationFrame(t=>{ lastFrame=t; animationLoop(t); });
    
  </script>
</body>
</html>
